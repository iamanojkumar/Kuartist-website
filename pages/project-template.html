<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style-sheet/main.css">
    <script src="/component-lib/navbar.js" defer></script>
    <title>Project</title>
</head>
<body>
    <nav-bar></nav-bar>
    <div class="max-width">
    <header>
        <h1 id="project-title" class="ptttl">Project Title</h1>
        <p id="project-description" class="ptdes">Project description goes here.</p>
    </header>
    <main>
        <img id="project-image" src="" alt="Project Image" class="ptimg">
        
        <div id="project-tags"></div> <!-- Container for tags -->
    </main>
    </div>
    <script>
        async function loadProject() {
            const params = new URLSearchParams(window.location.search);
            const projectId = params.get('id');

            try {
                const response = await fetch(`/fetch-project/${projectId}`, { // Fetch project data from your server
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                if (!response.ok) {
                    throw new Error(`Error fetching project: ${response.statusText}`);
                }

                const project = await response.json();

                // Update the DOM with project data
                document.getElementById('project-title').textContent = project.properties.title.title[0]?.text.content || 'Untitled';
                document.getElementById('project-image').src = project.properties.thumbnail.url || 'Image/boy in vr.jpeg'; // Fallback image
                document.getElementById('project-description').textContent = project.properties.description.rich_text[0]?.text.content || 'No description available.';

                // Display tags
                const tagsContainer = document.getElementById('project-tags');
                const tags = project.properties.tag.relation; // Accessing the relation tags
                if (tags.length > 0) {
                    tags.forEach(tag => {
                        const tagElement = document.createElement('span');
                        tagElement.textContent = tag.name; // Assuming tag has a 'name' property
                        tagElement.className = 'tag'; // Add a class for styling
                        tagElement.onclick = (e) => {
                            e.stopPropagation(); // Prevent card click event
                            // Redirect to a filtered projects page based on the tag
                            window.location.href = `projects.html?tag=${tag.id}`; // Assuming you have a way to filter by tag ID
                        };
                        tagsContainer.appendChild(tagElement);
                    });
                } else {
                    tagsContainer.textContent = 'No Tags'; // Fallback if no tags
                }

            } catch (error) {
                console.error('Error loading project:', error);
                document.getElementById('project-description').textContent = 'Error loading project data.';
            }
        }

        window.onload = loadProject;
    </script>
</body>
</html>
